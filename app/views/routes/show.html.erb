 <div class="container my-5">
  <div class="row d-flex justify-content-center py-3">
    <div class="col-9">
      <div class="card card-img show-route-card">
        <% if @route.photo.attached? %>
          <%= cl_image_tag @route.photo.key, height: 600, width: 900, crop: :fill, class:"card-img show-route-card" %>
        <% end %>
        <div class="card-img-overlay d-flex align-items-end flex-column">
          <div class="mini-map mt-auto p-2", style="width: 20%; height: 150px;" data-controller="map" data-map-markers-value="<%= @markers.to_json %>" data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
        </div>
      </div>

      <div class="col-8 mb-2 w-100 d-flex justify-content-start">
        <div class="mt-3 mb-1">
          <h2 class="card-text"><%= @route.name %></h2>
          <p class="card-text">Address: <%= @route.address %></p>

          <% if current_user.walker_status == true %>
            <%= link_to "Edit this route", edit_route_path(@route), class:"btn btn-outline-secondary"%>
            <%= link_to "Delete this route", route_path(@route), data: {turbo_method: :delete}, class:"btn btn-outline-secondary" %>
        </div>
      </div>
    </div>

    <div class="col-sm-3 form-record shadow justify-content-center">
      <h3>New record</h3>
        <%= simple_form_for [@route, @record] do |f| %>
          <%= f.input :start_time, as: :date, html5: true, input_html: { type: 'datetime-local' }%>
          <%= f.input :end_time, as: :date, html5: true, input_html: { type: 'datetime-local' }, minute_step: 15 %>
          <%= f.input :available, input_html: { min: '1', max: '10' } %>
          <%= f.submit %>
        <% end %>
      <% end %>
    </div>

  </div>

  <hr>
  <div class="row d-flex justify-content-between">
    <% @route.records.each do |record| %>
    <div class="card bg-light mb-3 m-1 show-route-card" style="max-width: 18rem;">
      <div class="card-header">Schedule</div>
      <div class="card-body">
        <p class="card-text">Start Time: <%= record.start_time %></p>
        <p class="card-text">End Time: <%= record.end_time %></p>
        <p class="card-text">Available: <%= record.available %></p>
      </div>
      <% if current_user.walker_status == true %>
          <%= link_to "Delete Record", record_path(record), data: {turbo_method: :delete}, class:"btn btn-outline-secondary" %>
        <% else %>
          <% if record.available > 0 %>
            <%= link_to "Reservation", new_record_reservation_path(record), class:"btn btn-outline-secondary" %>
          <% else %>
            <%= "No more available spots" %>
          <% end %>
      <% end %>
    </div>
    <% end %>
  </div>

</div>
