 <div class="container mb-5">
  <div class="row d-flex justify-content-center py-3">
    <div class="col-9">
      <div class="card card-img show-route-card">
        <% if @route.photo.attached? %>
          <%= cl_image_tag @route.photo.key, height: 600, width: 900, crop: :fill, class:"card-img show-route-card" %>
        <% end %>
        <div class="card-img-overlay d-flex align-items-end flex-column">
          <div class="mini-map mt-auto p-2", style="width: 25%; height: 150px;" data-controller="map" data-map-markers-value="<%= @markers.to_json %>" data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
          </div>
        </div>
      </div>
      <div class="col-8 mb-2 w-100 d-flex justify-content-start">
        <div class="mt-3 mb-1">
          <h2 class="card-text"><%= @route.name %></h2>
          <p class="card-text">Address: <%= @route.address %></p>
          <p class="card-text">Walker: <%= @route.user.first_name %></p>
          <% if current_user.walker_status == true %>
            <div>
              <%= link_to edit_route_path(@route), class:"btn btn-outline-secondary" do%>
               <i class="fa-solid fa-pen-to-square"></i>
              <% end %>
              <%= link_to route_path(@route), data: {turbo_method: :delete}, class:"btn btn-outline-secondary" do%>
                <i class="fa-solid fa-trash"></i>
              <% end %>
            </div>
        </div>
      </div>
    </div>
    <div class="col-3 form-record shadow">
      <div class="mt-3">
        <h3 class="text-center">New record</h3>
          <%= simple_form_for [@route, @record] do |f| %>
            <%= f.input :start_time, as: :date, html5: true, input_html: { type: 'datetime-local' }%>
            <%= f.input :end_time, as: :date, html5: true, input_html: { type: 'datetime-local' }, minute_step: 15 %>
            <%= f.input :available, input_html: { min: '1', max: '10' } %>
            <%= f.submit %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <hr>
  <div class="row d-flex justify-content-between">
    <% @route.records.each do |record| %>
    <div class="card bg-light mb-3 m-1 show-route-card" style="max-width: 18rem;">
      <div class="card-header text-center"><h5>Schedule</h5></div>
      <div class="card-body">
        <p class="card-text"><strong>Start Time: </strong><%= record.start_time %></p>
        <p class="card-text"><strong>End Time: </strong><%= record.end_time %></p>
        <p class="card-text"><strong>Available: </strong><%= record.available %></p>
      </div>
      <% if current_user.walker_status == true %>
        <%= link_to record_path(record), data: {turbo_method: :delete}, class:"btn" do%>
          <i class="fa-solid fa-trash"></i>
        <% end %>
        <% else %>
        <% if record.available > 0 %>
          <%= link_to "Reservation", new_record_reservation_path(record), class:"btn btn-outline-secondary" %>
        <% else %>
          <%= "No more available spots" %>
        <% end %>
      <% end %>
    </div>
    <% end %>
  </div>
</div>
